{"remainingRequest":"/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js??vue-loader-options!/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/src/views/student/HistoryOrder.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/src/views/student/HistoryOrder.vue","mtime":1625946131164},{"path":"/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgZ2V0T3JkZXJzQnlVc2VyLCBwYXlPcmRlciB9IGZyb20gIkAvYXBpL29yZGVyIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJIaXN0b3J5T3JkZXIiLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjb2xvckxpc3Q6IFsiI0ZGQUI5MSIsICIjMjZBNjlBIiwgIiMwMzlCRTUiLCAiIzU0NkU3QSIsICIjQjM5RERCIiwgIiNFRjlBOUEiXSwKICAgICAgb3JkZXJMaXN0OiBbXSwKICAgICAgZGlhbG9nQnV5UGF5OiBmYWxzZSwKICAgICAgZGlhbG9nUmVudFBheTogZmFsc2UsCiAgICAgIGN1cnJlbnRPcmRlcklkOiAiIiwKICAgICAgY3VycmVudE9yZGVyQ29zdDogIiIsCiAgICAgIGN1cnJlbnRPcmRlclJlbnRUaW1lOiAiIiwKICAgICAgc2hvd1NuYWNrQmFyOiAiIiwKICAgICAgc25hY2tCYXJDb2xvcjogIiIsCiAgICAgIHNuYWNrQmFyTXNnOiAiIgogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGhhbmRsZVN0dWR5OiBmdW5jdGlvbiBoYW5kbGVTdHVkeShjb3Vyc2VJZCkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL3N0dWRlbnQvY291cnNlLyIuY29uY2F0KGNvdXJzZUlkKSk7CiAgICB9LAogICAgaGFuZGxlUmVudDogZnVuY3Rpb24gaGFuZGxlUmVudChvcmRlcikgewogICAgICB0aGlzLmRpYWxvZ1JlbnRQYXkgPSB0cnVlOwogICAgICB0aGlzLmN1cnJlbnRPcmRlckNvc3QgPSBvcmRlci5jb3N0OwogICAgICB0aGlzLmN1cnJlbnRPcmRlcklkID0gb3JkZXIuaWQ7CiAgICAgIHRoaXMuY3VycmVudE9yZGVyUmVudFRpbWUgPSBvcmRlci50aW1lOwogICAgfSwKICAgIGhhbmRsZUJ1eTogZnVuY3Rpb24gaGFuZGxlQnV5KG9yZGVyKSB7CiAgICAgIHRoaXMuZGlhbG9nQnV5UGF5ID0gdHJ1ZTsKICAgICAgdGhpcy5jdXJyZW50T3JkZXJDb3N0ID0gb3JkZXIuY29zdDsKICAgICAgdGhpcy5jdXJyZW50T3JkZXJJZCA9IG9yZGVyLmlkOwogICAgfSwKICAgIHBheTogZnVuY3Rpb24gcGF5KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcGF5T3JkZXIodGhpcy5jdXJyZW50T3JkZXJJZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgaWYgKHJlcy5jb2RlID09PSAwKSB7CiAgICAgICAgICBfdGhpcy5zbmFja0JhckNvbG9yID0gImVycm9yIjsKICAgICAgICAgIF90aGlzLnNuYWNrQmFyTXNnID0gcmVzLm1zZzsKICAgICAgICAgIF90aGlzLnNob3dTbmFja0JhciA9IHRydWU7CiAgICAgICAgICBfdGhpcy5kaWFsb2cgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLmRpYWxvZ1JlbnRQYXkgPSBmYWxzZTsKICAgICAgdGhpcy5kaWFsb2dCdXlQYXkgPSBmYWxzZTsKICAgIH0sCiAgICBvcmRlclRvUmVudDogZnVuY3Rpb24gb3JkZXJUb1JlbnQob3JkZXIpIHsKICAgICAgcmV0dXJuIHRoaXMub3JkZXJJc1JlbnQob3JkZXIpICYmICF0aGlzLm9yZGVySXNPayhvcmRlcik7CiAgICB9LAogICAgb3JkZXJUb0J1eTogZnVuY3Rpb24gb3JkZXJUb0J1eShvcmRlcikgewogICAgICByZXR1cm4gb3JkZXIucHVyY2hhc2VUeXBlID09PSAnQnV5JyAmJiBvcmRlci5zdGF0dXMgIT09IDE7CiAgICB9LAogICAgb3JkZXJJc1JlbnQ6IGZ1bmN0aW9uIG9yZGVySXNSZW50KG9yZGVyKSB7CiAgICAgIHJldHVybiBvcmRlci5wdXJjaGFzZVR5cGUgPT09ICdSZW50JzsKICAgIH0sCiAgICBvcmRlcklzT2s6IGZ1bmN0aW9uIG9yZGVySXNPayhvcmRlcikgewogICAgICBpZiAob3JkZXIucHVyY2hhc2VUeXBlID09PSAiQnV5IiAmJiBvcmRlci5zdGF0dXMgPT09IDEpIHJldHVybiB0cnVlOwoKICAgICAgaWYgKG9yZGVyLnB1cmNoYXNlVHlwZSA9PT0gJ1JlbnQnICYmIG9yZGVyLnN0YXR1cyA9PT0gMSkgewogICAgICAgIHZhciBub3cgPSBEYXRlLnBhcnNlKERhdGUoKSk7CiAgICAgICAgdmFyIG9yZGVyRW5kVGltZSA9IERhdGUucGFyc2Uob3JkZXIuZW5kVGltZSk7CgogICAgICAgIGlmIChvcmRlckVuZFRpbWUgPiBub3cpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgIHZhciB1aWQgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJJZCIpOwogICAgZ2V0T3JkZXJzQnlVc2VyKHVpZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgIF90aGlzMi5vcmRlckxpc3QgPSByZXMgfHwgW107CiAgICB9KTsKICB9Cn07"},{"version":3,"sources":["HistoryOrder.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <v-container class=\"ma-8 pa-4\">\n      <v-card\n          v-for=\"o in orderList\"\n          :key=\"o.id\"\n          :color=\"colorList[o.id % colorList.length]\"\n          class=\"ma-8 pa-4\"\n      >\n        <v-card-title class=\"headline\">\n          {{ o.courseName }}\n        </v-card-title>\n\n        <v-card-subtitle class=\"mt-1\">\n          创建时间: {{ o.createTime }}\n        </v-card-subtitle>\n        <v-card-subtitle v-if=\"orderIsRent(o)\" class=\"mt-1\">\n          租用时间: {{ o.time }}\n        </v-card-subtitle>\n        <v-card-actions class=\"pa-0 pl-2\">\n          <v-btn v-if=\"orderIsOk(o)\" text @click=\"handleStudy(o.courseId)\">学习课程</v-btn>\n          <v-btn v-if=\"orderToRent(o)\" text @click=\"handleRent(o)\">支付订单</v-btn>\n          <v-btn v-if=\"orderToBuy(o)\" text @click=\"handleBuy(o)\">支付订单</v-btn>\n        </v-card-actions>\n      </v-card>\n\n      <v-dialog v-model=\"dialogRentPay\" width=\"1000\">\n        <v-card>\n          <v-card-title>支付订单</v-card-title>\n          <v-card-text>租用时间:  {{ currentOrderRentTime }}</v-card-text>\n          <v-card-text>租用费用:  {{ currentOrderCost }}</v-card-text>\n\n          <v-divider></v-divider>\n\n          <v-card-actions>\n            <v-spacer></v-spacer>\n            <v-btn color=\"primary\" text @click=\"pay()\">支付</v-btn>\n            <v-btn color=\"primary\" text @click=\"dialogRentPay=false\">取消</v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-dialog>\n\n      <v-dialog v-model=\"dialogBuyPay\" width=\"1000\">\n        <v-card>\n          <v-card-title>支付订单</v-card-title>\n          <v-card-text>购买费用:{{ currentOrderCost }}</v-card-text>\n\n          <v-divider></v-divider>\n\n          <v-card-actions>\n            <v-spacer></v-spacer>\n            <v-btn color=\"primary\" text @click=\"pay()\">支付</v-btn>\n            <v-btn color=\"primary\" text @click=\"dialogBuyPay=false\">取消</v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-dialog>\n\n      <v-snackbar v-model=\"showSnackBar\" :color=\"snackBarColor\" top>\n        {{ snackBarMsg }}\n      </v-snackbar>\n    </v-container>\n  </div>\n</template>\n\n<script>\nimport {getOrdersByUser, payOrder} from \"@/api/order\";\n\nexport default {\n  name: \"HistoryOrder\",\n  data() {\n    return {\n      colorList: [\n        \"#FFAB91\",\n        \"#26A69A\",\n        \"#039BE5\",\n        \"#546E7A\",\n        \"#B39DDB\",\n        \"#EF9A9A\"\n      ],\n      orderList: [],\n      dialogBuyPay: false,\n      dialogRentPay: false,\n      currentOrderId: \"\",\n      currentOrderCost: \"\",\n      currentOrderRentTime: \"\",\n      showSnackBar:\"\",\n      snackBarColor:\"\",\n      snackBarMsg:\"\"\n    };\n  },\n\n  methods: {\n    handleStudy(courseId) {\n      this.$router.push(`/student/course/${courseId}`);\n    },\n    handleRent(order) {\n      this.dialogRentPay = true\n      this.currentOrderCost = order.cost\n      this.currentOrderId = order.id\n      this.currentOrderRentTime = order.time\n    },\n    handleBuy(order) {\n      this.dialogBuyPay = true\n      this.currentOrderCost = order.cost\n      this.currentOrderId = order.id\n    },\n    pay() {\n      payOrder(this.currentOrderId).then(res => {\n        if (res.code === 0) {\n          this.snackBarColor = \"error\";\n          this.snackBarMsg = res.msg;\n          this.showSnackBar = true;\n          this.dialog = false;\n        }\n      })\n      this.dialogRentPay = false\n      this.dialogBuyPay = false\n    },\n    orderToRent(order) {\n      return this.orderIsRent(order) && !this.orderIsOk(order);\n    },\n    orderToBuy(order) {\n      return order.purchaseType === 'Buy' && order.status !== 1\n    },\n    orderIsRent(order) {\n      return order.purchaseType === 'Rent'\n    },\n    orderIsOk(order) {\n      if (order.purchaseType === \"Buy\" && order.status === 1)\n        return true\n      if (order.purchaseType === 'Rent'&& order.status === 1) {\n        let now = Date.parse(Date());\n        let orderEndTime = Date.parse(order.endTime)\n        if (orderEndTime > now) {\n          return true\n        }\n      }\n      return false\n    }\n  },\n\n  mounted() {\n    const uid = window.localStorage.getItem(\"userId\");\n    getOrdersByUser(uid).then(res => {\n      console.log(res);\n      this.orderList = res || [];\n    });\n  }\n};\n</script>\n"],"sourceRoot":"src/views/student"}]}