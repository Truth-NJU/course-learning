{"remainingRequest":"/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js??vue-loader-options!/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/src/views/student/UserCenter.vue?vue&type=style&index=0&id=06ae520e&scoped=true&lang=css&","dependencies":[{"path":"/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/src/views/student/UserCenter.vue","mtime":1625946141691},{"path":"/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/node_modules/_vue-loader@15.9.7@vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/taozehua/Downloads/软工2大作业/course-learning-frontend/node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmFsZXJ0IHsKICBwb3NpdGlvbjogZml4ZWQ7CiAgbGVmdDogNTAlOwogIHRvcDogMTAwcHg7CiAgei1pbmRleDogOTk5Owp9CgoucGVpIHsKICB3aWR0aDogZml0LWNvbnRlbnQ7CiAgcG9zaXRpb246IGZpeGVkOwogIGxlZnQ6IDUwJTsKICB0b3A6IDEwMHB4OwogIHotaW5kZXg6IDk5OTsKfQoKLmZpeGVkIHsKICBwb3NpdGlvbjogZml4ZWQ7Cn0KCiNzaG93IHsKICBmbG9hdDogcmlnaHQ7Cn0K"},{"version":3,"sources":["UserCenter.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4eA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"UserCenter.vue","sourceRoot":"src/views/student","sourcesContent":["<template>\n  <div>\n    <!-- alert -->\n    <v-alert\n      class=\"alert green\"\n      outlined\n      text\n      v-show=\"showAlert\"\n      transition=\"scroll-y-transition\"\n    >\n      {{ msg }}\n    </v-alert>\n\n    <template>\n      <v-dialog v-model=\"vip_dialog\" max-width=\"560\" class=\"ma-1\">\n        <v-card max-width=\"540\">\n          <v-card-title class=\"headline\">\n            充值会员\n          </v-card-title>\n          <v-row>\n            <vip-card\n              v-for=\"vip in vip_info\"\n              :key=\"vip.id\"\n              :type=\"vip.type\"\n              :money=\"vip.money\"\n              :time=\"vip.time\"\n              :id=\"userInfo.id\"\n              class=\"ma-4\"\n              :color=\"colorList[vip.id % colorList.length]\"\n              @buy-vip=\"be_vip(vip.type)\"\n            >\n            </vip-card>\n          </v-row>\n\n          <v-card-actions>\n            <v-spacer></v-spacer>\n            <v-btn color=\"green darken-1\" text @click=\"vip_dialog = false\">\n              取消\n            </v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-dialog>\n    </template>\n\n    <template>\n      <v-dialog v-model=\"dialog\" max-width=\"400\">\n        <v-card>\n          <v-card-title class=\"headline\">\n            账户充值\n          </v-card-title>\n          <v-text-field\n            v-model=\"value\"\n            label=\"充值金额\"\n            class=\"pa-6\"\n          ></v-text-field>\n\n          <v-card-actions>\n            <v-spacer></v-spacer>\n\n            <v-btn color=\"green darken-1\" text @click=\"handleRecharge\">\n              充值\n            </v-btn>\n\n            <v-btn color=\"green darken-1\" text @click=\"dialog = false\">\n              取消\n            </v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-dialog>\n    </template>\n\n    <div>\n      <v-card class=\"ml-1 mt-8 fixed\">\n        <v-navigation-drawer permanent expand-on-hover width=\"170\">\n          <v-list>\n            <v-list-item class=\"px-2\">\n              <v-list-item-avatar>\n                <v-img\n                  src=\"https://randomuser.me/api/portraits/women/85.jpg\"\n                ></v-img>\n              </v-list-item-avatar>\n              <v-list-item-content>\n                <v-list-item-subtitle class=\"text-h6\">\n                  {{ userInfo.uname }}\n                </v-list-item-subtitle>\n                <v-list-item-subtitle>\n                  {{ userInfo.phone }}\n                </v-list-item-subtitle>\n              </v-list-item-content>\n            </v-list-item>\n          </v-list>\n          <v-divider></v-divider>\n\n          <v-list nav dense>\n            <v-list-item link @click=\"to_center\">\n              <v-list-item-icon>\n                <v-icon>mdi-folder</v-icon>\n              </v-list-item-icon>\n              <v-list-item-title>个人中心</v-list-item-title>\n            </v-list-item>\n            <v-list-item link @click=\"to_recharge\">\n              <v-list-item-icon>\n                <v-icon>mdi-account-multiple</v-icon>\n              </v-list-item-icon>\n              <v-list-item-title>我的课程</v-list-item-title>\n            </v-list-item>\n            <v-list-item link @click=\"to_vip\">\n              <v-list-item-icon>\n                <v-icon>mdi-star</v-icon>\n              </v-list-item-icon>\n              <v-list-item-title>会员中心</v-list-item-title>\n            </v-list-item>\n            <v-list-item link @click=\"toMyPost\">\n              <v-list-item-icon>\n                <v-icon>mdi-folder</v-icon>\n              </v-list-item-icon>\n              <v-list-item-title>我的帖子</v-list-item-title>\n            </v-list-item>\n            <v-list-item link @click=\"toMyReply\">\n              <v-list-item-icon>\n                <v-icon>mdi-folder</v-icon>\n              </v-list-item-icon>\n              <v-list-item-title>我的回复</v-list-item-title>\n            </v-list-item>\n          </v-list>\n        </v-navigation-drawer>\n      </v-card>\n    </div>\n    <div>\n      <v-container class=\"pl-lg-16\">\n        <v-card class=\"pa-12 mt-8 purple lighten-5\">\n          <div v-if=\"show_what === 0\">\n            <v-row justify=\"space-around\">\n              <v-avatar size=\"120\">\n                <img\n                  src=\"https://cdn.vuetifyjs.com/images/john.jpg\"\n                  alt=\"John\"\n                />\n              </v-avatar>\n              <v-col class=\"ml-8\">\n                <p>{{ userInfo.uname }}</p>\n                <p>{{ userInfo.userRole }}</p>\n                <p v-if=\"userInfo.isVip === 0\">普通用户</p>\n                <p v-if=\"userInfo.isVip === 1\">会员</p>\n              </v-col>\n            </v-row>\n            <v-text-field\n              v-model=\"userInfo.phone\"\n              label=\"手机号\"\n              readonly\n              class=\"mt-5\"\n            ></v-text-field>\n            <v-text-field\n              v-model=\"userInfo.createTime\"\n              label=\"注册时间\"\n              readonly\n            ></v-text-field>\n            <v-text-field\n              v-model=\"userInfo.balance\"\n              label=\"账户余额\"\n              readonly\n            ></v-text-field>\n            <v-btn color=\"primary\" dark @click.stop=\"dialog = true\">\n              充值\n            </v-btn>\n          </div>\n          <div v-if=\"show_what === 1\">\n            <v-row class=\"mt-8 mb-2\">\n              <v-chip\n                class=\"ma-2\"\n                color=\"deep-purple lighten-3\"\n                label\n                text-color=\"white\"\n              >\n                <v-icon left>\n                  mdi-label\n                </v-icon>\n                我的已购课程\n              </v-chip>\n            </v-row>\n            <v-row>\n              <course-item\n                cols=\"12\"\n                md=\"4\"\n                v-for=\"course in course\"\n                :key=\"course.id\"\n                :courseName=\"course.name\"\n                :courseId=\"course.id\"\n                :description=\"course.intro\"\n                :type=\"course.type\"\n                :cost=\"course.cost\"\n                :bought=\"course.bought\"\n                :manageable=\"course.manageable\"\n                :course-color=\"colorList[course.id % colorList.length]\"\n              >\n              </course-item>\n            </v-row>\n          </div>\n          <div v-if=\"show_what === 2\">\n            <v-card style=\"text-align: center\" class=\"pa-5 teal lighten-4\">\n              <div v-if=\"userInfo.isVip === 0\">\n                <p>您还不是会员，无法尊享会员权益</p>\n                <v-btn @click=\"getVip\">成为会员</v-btn>\n              </div>\n              <div v-if=\"userInfo.isVip === 1\">\n                <p>您已是会员</p>\n                <p>到期时间：{{ userInfo.vipEndTime }}</p>\n                <v-btn @click=\"getVip\">点击续费</v-btn>\n              </div>\n              <v-carousel\n                cycle\n                height=\"400\"\n                hide-delimiter-background\n                show-arrows-on-hover\n              >\n                <v-carousel-item v-for=\"(slide, i) in slides\" :key=\"i\">\n                  <p style=\"color: black\">\n                    {{ slide }}\n                  </p>\n                </v-carousel-item>\n              </v-carousel>\n            </v-card>\n          </div>\n          <div v-if=\"show_what === 3\">\n            <li v-for=\"(post, key, index) in postLists\" :key=\"index\">\n              <v-card elevation=\"1\">\n                <v-card-title>{{ post.postTitle }}</v-card-title>\n                <v-card-text>{{ post.postContent }}</v-card-text>\n              </v-card>\n            </li>\n            <v-pagination\n              v-model=\"pageNoForPost\"\n              :length=\"totalPagesForPost\"\n              @next=\"getNextPostLists\"\n              @previous=\"getPreviousPostLists\"\n            >\n            </v-pagination>\n          </div>\n          <div v-if=\"show_what === 4\">\n            <v-card-title>您有{{ totalReplyNum }}个新回复</v-card-title>\n            <li v-for=\"(reply, key, index) in replyLists\" :key=\"index\">\n              <v-card elevation=\"1\">\n                <v-card-title>{{ reply.replyContent }}</v-card-title>\n              </v-card>\n            </li>\n            <v-pagination\n              v-model=\"pageNoForReply\"\n              :length=\"totalPagesForReply\"\n              @next=\"getNextReplyLists\"\n              @previous=\"getPreviousReplyLists\"\n            >\n            </v-pagination>\n          </div>\n        </v-card>\n      </v-container>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { getUser } from \"@/api/user\";\nimport { recharge } from \"@/api/recharge\";\nimport { getBoughtCourses } from \"@/api/course\";\nimport { get_vip_info } from \"@/api/vip\";\nimport { buy_vip } from \"@/api/vip\";\nimport CourseItem from \"@/components/CourseItemSimple\";\nimport VipCard from \"@/components/VipCard\";\nimport axios from \"axios\";\n\nexport default {\n  name: \"UserCenter\",\n  components: {\n    CourseItem,\n    VipCard\n  },\n  data() {\n    return {\n      userInfo: {\n        id: 0,\n        uname: \"\",\n        phone: \"\",\n        password: null,\n        picture: null,\n        balance: 0,\n        userRole: \"\",\n        createTime: \"\",\n        isVip: 0,\n        vipEndTime: \"\"\n      },\n      dialog: false,\n      vip_dialog: false,\n      showAlert: false,\n      value: 0,\n      msg: \"\",\n      show_what: 0,\n      course: [],\n      colorList: [\"#26A69A\", \"#00B0FF\", \"#5C6BC0\", \"#FFB300\", \"#E57373\"],\n      slides: [\"尊贵标识\", \"专有课程\"],\n      vip_info: [],\n      postLists: [],\n      pageNoForPost: 1,\n      numberForPost: 4,\n      totalPagesForPost: 0,\n      replyLists: [],\n      pageNoForReply: 1,\n      numberForReply: 4,\n      totalPagesForReply: 0,\n      totalReplyNum: 0\n    };\n  },\n\n  created() {\n    let instance = axios.create({\n      baseURL: \"http://localhost:8081/api\",\n      timeout: 1000 // 超时时长\n    });\n    instance\n      .get(\n        `/post/search/userPost/${this.pageNoForPost}/${\n          this.numberForPost\n        }?userId=${window.localStorage.getItem(\"userId\")}`\n      )\n      .then(res => {\n        //console.log(res.data);\n        this.postLists = res.data.list;\n        this.totalPagesForPost = res.data.pages;\n        console.log(this.postLists);\n      });\n    instance\n      .get(\n        `/post/search/userReply/${this.pageNoForReply}/${\n          this.numberForReply\n        }?userId=${window.localStorage.getItem(\"userId\")}`\n      )\n      .then(res => {\n        //console.log(res.data);\n        this.replyLists = res.data.list;\n        let i = 0;\n        for (i = 0; i < this.replyLists.length; i++) {\n          this.totalReplyNum += res.data.list[i].newReplyNum;\n        }\n        this.totalPagesForReply = res.data.pages;\n        console.log(this.replyLists);\n      });\n  },\n  methods: {\n    getNextReplyLists() {\n      //this.pageNoForReply++;\n      let instance = axios.create({\n        baseURL: \"http://localhost:8081/api\",\n        timeout: 1000 // 超时时长\n      });\n      instance\n        .get(\n          `/post/search/userReply/${this.pageNoForReply}/${\n            this.numberForReply\n          }?userId=${window.localStorage.getItem(\"userId\")}`\n        )\n        .then(res => {\n          console.log(res);\n          this.replyLists = res.data.list;\n          let i = 0;\n          for (i = 0; i < this.replyLists.length; i++) {\n            this.totalReplyNum += res.data.list[i].newReplyNum;\n          }\n          this.totalPagesForReply = res.data.pages;\n        });\n    },\n    getPreviousReplyLists() {\n      let instance = axios.create({\n        baseURL: \"http://localhost:8081/api\",\n        timeout: 1000 // 超时时长\n      });\n      instance\n        .get(\n          `/post/search/userReply/${this.pageNoForReply}/${\n            this.numberForReply\n          }?userId=${window.localStorage.getItem(\"userId\")}`\n        )\n        .then(res => {\n          console.log(res);\n          this.replyLists = res.data.list;\n          let i = 0;\n          for (i = 0; i < this.replyLists.length; i++) {\n            this.totalReplyNum += res.data.list[i].newReplyNum;\n          }\n          this.totalPagesForReply = res.data.pages;\n        });\n    },\n    getNextPostLists() {\n      let instance = axios.create({\n        baseURL: \"http://localhost:8081/api\",\n        timeout: 1000 // 超时时长\n      });\n      instance\n        .get(\n          `/post/search/userPost/${this.pageNoForPost}/${\n            this.numberForPost\n          }?userId=${window.localStorage.getItem(\"userId\")}`\n        )\n        .then(res => {\n          console.log(res.data.list);\n          this.postLists = res.data.list;\n        });\n    },\n    getPreviousPostLists() {\n      let instance = axios.create({\n        baseURL: \"http://localhost:8081/api\",\n        timeout: 1000 // 超时时长\n      });\n      instance\n        .get(\n          `/post/search/userPost/${this.pageNoForPost}/${\n            this.numberForPost\n          }?userId=${window.localStorage.getItem(\"userId\")}`\n        )\n        .then(res => {\n          console.log(res.data.list);\n          this.postLists = res.data.list;\n        });\n    },\n    handleRecharge() {\n      recharge({ userId: this.userInfo.id, value: this.value }).then(res => {\n        console.log(res);\n        if (res && res.code === 1) {\n          this.msg = res.msg;\n          this.dialog = false;\n          this.showAlert = true;\n          this.refreshUserInfo();\n          setTimeout(() => {\n            this.showAlert = false;\n          }, 1000);\n        }\n      });\n    },\n\n    getCourse() {\n      const uid = window.localStorage.getItem(\"userId\");\n      getBoughtCourses(uid).then(res => {\n        this.course = res || [];\n      });\n    },\n    getVip() {\n      this.vip_dialog = true;\n      get_vip_info().then(res => {\n        this.vip_info = res.data;\n      });\n    },\n    be_vip(type) {\n      buy_vip({ userId: this.userInfo.id, type: type }).then(res => {\n        this.msg = res.msg;\n        this.dialog = false;\n        this.showAlert = true;\n        this.refreshUserInfo();\n        setTimeout(() => {\n          this.showAlert = false;\n        }, 1000);\n      });\n    },\n\n    refreshUserInfo() {\n      const userId = window.localStorage.getItem(\"userId\");\n      getUser(userId).then(res => {\n        this.userInfo = res || {};\n      });\n    },\n\n    to_recharge() {\n      this.show_what = 1;\n    },\n    to_center() {\n      this.show_what = 0;\n    },\n    to_vip() {\n      this.show_what = 2;\n    },\n    toMyPost() {\n      this.show_what = 3;\n    },\n    toMyReply() {\n      this.show_what = 4;\n    }\n  },\n\n  mounted() {\n    this.refreshUserInfo();\n    this.getCourse();\n  }\n};\n</script>\n\n<style scoped>\n.alert {\n  position: fixed;\n  left: 50%;\n  top: 100px;\n  z-index: 999;\n}\n\n.pei {\n  width: fit-content;\n  position: fixed;\n  left: 50%;\n  top: 100px;\n  z-index: 999;\n}\n\n.fixed {\n  position: fixed;\n}\n\n#show {\n  float: right;\n}\n</style>\n"]}]}